<VirtualHost *:80>
    ServerName localhost
    DocumentRoot /var/www/html

    # Definiuje kolejność sprawdzania plików indeksu
    DirectoryIndex index.html index.htm index.php

    <Directory "/var/www/html">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    <FilesMatch "\.php$">
        # Domyślny handler
        SetHandler "proxy:fcgi://php74:9000"

        # Dynamiczne przełączanie na debugera na podstawie ciasteczka
        <If "%{HTTP_COOKIE} =~ /XDEBUG_(SESSION|TRIGGER)/">
            SetHandler "proxy:fcgi://php74_xdebug:9000"
        </If>
    </FilesMatch>
</VirtualHost>